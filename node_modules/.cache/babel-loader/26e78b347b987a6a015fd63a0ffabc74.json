{"ast":null,"code":"var _jsxFileName = \"/home/raven/Documents/programming/proyects/addresses_app/bery/berry-free-react-admin-template/src/ui-component/addresses/maps/mapbox/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport './css/markersStyle.css';\nimport ReactMapGL, { Layer } from 'react-map-gl';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\n// Redux\n\nimport { useDispatch, useSelector } from \"react-redux\"; //console.log('MAPBOXGL', mapboxgl)\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nmapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYXN0aWFuY3JvdyIsImEiOiJja3VnOW5yazUwanYwMm9waHY1NWdoaHRnIn0.kIsU3HWfUybUwU2DvavkwA';\nconst stores = {\n  \"type\": \"FeatureCollection\",\n  \"features\": [{\n    \"type\": \"Feature\",\n    \"geometry\": {\n      \"type\": \"Point\",\n      \"coordinates\": [-75.512527, 6.343636]\n    },\n    \"properties\": {\n      \"phoneFormatted\": \"3195158887\",\n      \"phone\": \"2022347336\",\n      \"address\": \"Carrera 57A N# 48-43\",\n      \"city\": \"Copacabana\",\n      \"country\": \"Colombia\",\n      \"crossStreet\": \"at 15th St NW\",\n      \"postalCode\": \"050022\" //\"state\": \"D.C.\"\n\n    }\n  }, {\n    \"type\": \"Feature\",\n    \"geometry\": {\n      \"type\": \"Point\",\n      \"coordinates\": [-75.561148, 6.259861]\n    },\n    \"properties\": {\n      \"phoneFormatted\": \"21171157\",\n      \"phone\": \"21171157\",\n      \"address\": \"Calle 64 #154, Medellín, Antioquia\",\n      \"city\": \"Medellin\",\n      \"country\": \"Colombia\",\n      \"crossStreet\": \"at 15th St NW\",\n      \"postalCode\": \"050022\" //\"state\": \"D.C.\"\n\n    }\n  }]\n};\n/* Assign a unique ID to each store */\n\nstores.features.forEach(function (store, i) {\n  store.properties.id = i;\n});\nexport const MapBox = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const position = useSelector(state => state.ui.position); //console.log('POSITION', position)\n\n  const userPosition = JSON.parse(position.replace(/'/g, '\"'));\n  console.log(userPosition);\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const [lng, setLng] = useState(userPosition.lat);\n  const [lat, setLat] = useState(userPosition.lng);\n  const [zoom, setZoom] = useState(13);\n\n  const buildLocationList = ({\n    features\n  }) => {\n    for (const {\n      properties\n    } of features) {\n      /* Add a new listing section to the sidebar. */\n      const listings = document.getElementById('listings');\n      const listing = listings.appendChild(document.createElement('div'));\n      /* Assign a unique `id` to the listing. */\n\n      listing.id = `listing-${properties.id}`;\n      /* Assign the `item` class to each listing for styling. */\n\n      listing.className = 'item';\n      /* Add the link to the individual listing created above. */\n\n      const link = listing.appendChild(document.createElement('a'));\n      link.href = '#';\n      link.className = 'title';\n      link.id = `link-${properties.id}`;\n      link.innerHTML = `${properties.address}`;\n      /* Add details to the individual listing. */\n\n      const details = listing.appendChild(document.createElement('div'));\n      details.innerHTML = `${properties.city}`;\n\n      if (properties.phone) {\n        details.innerHTML += ` · ${properties.phoneFormatted}`;\n      }\n\n      if (properties.distance) {\n        const roundedDistance = Math.round(properties.distance * 100) / 100;\n        details.innerHTML += `<div><strong>${roundedDistance} miles away</strong></div>`;\n      } // Event Listener\n\n\n      link.addEventListener('click', function () {\n        for (const feature of features) {\n          if (this.id === `link-${feature.properties.id}`) {\n            flyToStore(feature);\n            createPopUp(feature);\n          }\n        }\n\n        const activeItem = document.getElementsByClassName('active');\n\n        if (activeItem[0]) {\n          activeItem[0].classList.remove('active');\n        }\n\n        this.parentNode.classList.add('active');\n      });\n    }\n  };\n\n  const flyToStore = currentFeature => {\n    map.current.flyTo({\n      center: currentFeature.geometry.coordinates,\n      zoom: 15\n    });\n  };\n\n  const createPopUp = currentFeature => {\n    const popUps = document.getElementsByClassName('mapboxgl-popup');\n    /** Check if there is already a popup on the map and if so, remove it */\n\n    if (popUps[0]) popUps[0].remove();\n    const popup = new mapboxgl.Popup({\n      closeOnClick: false\n    }).setLngLat(currentFeature.geometry.coordinates).setHTML(`<h3>Addresss</h3><h4>${currentFeature.properties.address}</h4>`).addTo(map.current);\n  };\n\n  useEffect(() => {\n    if (map.current) return; // initialize map only once\n\n    map.current = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [lng, lat],\n      //center: [-77.034084, 38.909671],\n      zoom: zoom\n    });\n    map.current.on('load', () => {\n      /* Add the data to your map as a layer \n      \n      map.current.addLayer({\n        id: 'locations',\n        type: 'circle',\n        // Add a GeoJSON source containing place coordinates and information.\n        source: {\n          type: 'geojson',\n          data: stores\n        }\n      });\n      */\n      // This function is for to load custom markers\n      map.current.addSource('places', {\n        type: 'geojson',\n        data: stores\n      });\n      buildLocationList(stores);\n      addMarkers();\n    });\n\n    const addMarkers = () => {\n      /* For each feature in the GeoJSON object above: */\n      for (const marker of stores.features) {\n        /* Create a div element for the marker. */\n        const el = document.createElement('div');\n        /* Assign a unique `id` to the marker. */\n\n        el.id = `marker-${marker.properties.id}`;\n        /* Assign the `marker` class to each marker for styling. */\n\n        el.className = 'marker';\n        /**\n         * Create a marker using the div element\n         * defined above and add it to the map.\n         **/\n\n        new mapboxgl.Marker(el, {\n          offset: [0, -23]\n        }).setLngLat(marker.geometry.coordinates).addTo(map.current);\n        el.addEventListener('click', e => {\n          /* Fly to the point */\n          flyToStore(marker);\n          /* Close all other popups and display popup for clicked store */\n\n          createPopUp(marker);\n          /* Highlight listing in sidebar */\n\n          const activeItem = document.getElementsByClassName('active');\n          e.stopPropagation();\n\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active');\n          }\n\n          const listing = document.getElementById(`listing-${marker.properties.id}`);\n          listing.classList.add('active');\n        });\n      }\n    };\n    /*\n    map.current.on('click', ({ point }) => {\n      // Determine if a feature in the \"locations\" layer exists at that point. \n      const features = map.current.queryRenderedFeatures(point, {\n        layers: ['locations']\n      });\n             // If it does not exist, return \n      if (!features.length) return;\n             const clickedPoint = features[0];\n             //Fly to the point \n      flyToStore(clickedPoint);\n             // Close all other popups and display popup for clicked store \n      createPopUp(clickedPoint);\n             // Highlight listing in sidebar (and remove highlight for all other listings) \n      const activeItem = document.getElementsByClassName('active');\n      if (activeItem[0]) {\n        activeItem[0].classList.remove('active');\n      }\n      const listing = document.getElementById(\n        `listing-${clickedPoint.properties.id}`\n      );\n      listing.classList.add('active');\n    });\n    */\n\n  });\n  useEffect(() => {\n    if (!map.current) return; // wait for map to initialize\n\n    map.current.on('move', () => {\n      setLng(map.current.getCenter().lng.toFixed(4));\n      setLat(map.current.getCenter().lat.toFixed(4));\n      setZoom(map.current.getZoom().toFixed(2));\n    });\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"heading\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Dealer Orders\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"listings\",\n        className: \"listings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainer,\n      className: \"map\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 261,\n    columnNumber: 9\n  }, this);\n}; //Longitude: {lng} | Latitude: {lat} | Zoom: {zoom}\n\n_s(MapBox, \"Om1Y2JPi3MIKlneU8M/BUT6EXyc=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = MapBox;\n\nvar _c;\n\n$RefreshReg$(_c, \"MapBox\");","map":{"version":3,"sources":["/home/raven/Documents/programming/proyects/addresses_app/bery/berry-free-react-admin-template/src/ui-component/addresses/maps/mapbox/index.js"],"names":["React","useRef","useEffect","useState","ReactMapGL","Layer","mapboxgl","useDispatch","useSelector","accessToken","stores","features","forEach","store","i","properties","id","MapBox","dispatch","position","state","ui","userPosition","JSON","parse","replace","console","log","mapContainer","map","lng","setLng","lat","setLat","zoom","setZoom","buildLocationList","listings","document","getElementById","listing","appendChild","createElement","className","link","href","innerHTML","address","details","city","phone","phoneFormatted","distance","roundedDistance","Math","round","addEventListener","feature","flyToStore","createPopUp","activeItem","getElementsByClassName","classList","remove","parentNode","add","currentFeature","current","flyTo","center","geometry","coordinates","popUps","popup","Popup","closeOnClick","setLngLat","setHTML","addTo","Map","container","style","on","addSource","type","data","addMarkers","marker","el","Marker","offset","e","stopPropagation","getCenter","toFixed","getZoom"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport './css/markersStyle.css'\nimport ReactMapGL, { Layer } from 'react-map-gl';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\n\n// Redux\nimport { useDispatch, useSelector } from \"react-redux\";\n\n\n//console.log('MAPBOXGL', mapboxgl)\nmapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYXN0aWFuY3JvdyIsImEiOiJja3VnOW5yazUwanYwMm9waHY1NWdoaHRnIn0.kIsU3HWfUybUwU2DvavkwA';\n\n\n\n\nconst stores = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [\n                    -75.512527,\n                    6.343636\n                ]\n            },\n            \"properties\": {\n                \"phoneFormatted\": \"3195158887\",\n                \"phone\": \"2022347336\",\n                \"address\": \"Carrera 57A N# 48-43\",\n                \"city\": \"Copacabana\",\n                \"country\": \"Colombia\",\n                \"crossStreet\": \"at 15th St NW\",\n                \"postalCode\": \"050022\",\n                //\"state\": \"D.C.\"\n            }\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [\n                    -75.561148,\n                    6.259861\n                ]\n            },\n            \"properties\": {\n                \"phoneFormatted\": \"21171157\",\n                \"phone\": \"21171157\",\n                \"address\": \"Calle 64 #154, Medellín, Antioquia\",\n                \"city\": \"Medellin\",\n                \"country\": \"Colombia\",\n                \"crossStreet\": \"at 15th St NW\",\n                \"postalCode\": \"050022\",\n                //\"state\": \"D.C.\"\n            }\n        },\n    ]\n}\n\n/* Assign a unique ID to each store */\nstores.features.forEach(function (store, i) {\n    store.properties.id = i;\n});\n\n\n\n\n\n\nexport const MapBox = () => {\n\n    const dispatch = useDispatch();\n    const position = useSelector((state) => state.ui.position);\n    //console.log('POSITION', position)\n    const userPosition = JSON.parse(position.replace(/'/g, '\"'))\n    console.log(userPosition)\n\n    const mapContainer = useRef(null);\n    const map = useRef(null);\n    const [lng, setLng] = useState(userPosition.lat);\n    const [lat, setLat] = useState(userPosition.lng);\n    const [zoom, setZoom] = useState(13);\n\n\n\n\n    const buildLocationList = ({ features }) => {\n        for (const { properties } of features) {\n            /* Add a new listing section to the sidebar. */\n            const listings = document.getElementById('listings');\n            const listing = listings.appendChild(document.createElement('div'));\n            /* Assign a unique `id` to the listing. */\n            listing.id = `listing-${properties.id}`;\n            /* Assign the `item` class to each listing for styling. */\n            listing.className = 'item';\n\n            /* Add the link to the individual listing created above. */\n            const link = listing.appendChild(document.createElement('a'));\n            link.href = '#';\n            link.className = 'title';\n            link.id = `link-${properties.id}`;\n            link.innerHTML = `${properties.address}`;\n\n            /* Add details to the individual listing. */\n            const details = listing.appendChild(document.createElement('div'));\n            details.innerHTML = `${properties.city}`;\n            if (properties.phone) {\n                details.innerHTML += ` · ${properties.phoneFormatted}`;\n            }\n            if (properties.distance) {\n                const roundedDistance = Math.round(properties.distance * 100) / 100;\n                details.innerHTML += `<div><strong>${roundedDistance} miles away</strong></div>`;\n            }\n\n            // Event Listener\n            link.addEventListener('click', function () {\n                for (const feature of features) {\n                    if (this.id === `link-${feature.properties.id}`) {\n                        flyToStore(feature);\n                        createPopUp(feature);\n                    }\n                }\n                const activeItem = document.getElementsByClassName('active');\n                if (activeItem[0]) {\n                    activeItem[0].classList.remove('active');\n                }\n                this.parentNode.classList.add('active');\n            });\n        }\n    }\n\n    const flyToStore = (currentFeature) => {\n        map.current.flyTo({\n            center: currentFeature.geometry.coordinates,\n            zoom: 15\n        });\n    }\n\n    const createPopUp = (currentFeature) => {\n        const popUps = document.getElementsByClassName('mapboxgl-popup');\n        /** Check if there is already a popup on the map and if so, remove it */\n        if (popUps[0]) popUps[0].remove();\n\n        const popup = new mapboxgl.Popup({ closeOnClick: false })\n            .setLngLat(currentFeature.geometry.coordinates)\n            .setHTML(`<h3>Addresss</h3><h4>${currentFeature.properties.address}</h4>`)\n            .addTo(map.current);\n    }\n\n\n\n    useEffect(() => {\n        if (map.current) return; // initialize map only once\n        map.current = new mapboxgl.Map({\n            container: mapContainer.current,\n            style: 'mapbox://styles/mapbox/streets-v11',\n            center: [lng, lat],\n            //center: [-77.034084, 38.909671],\n            zoom: zoom\n        });\n        map.current.on('load', () => {\n            /* Add the data to your map as a layer \n            \n            map.current.addLayer({\n              id: 'locations',\n              type: 'circle',\n              // Add a GeoJSON source containing place coordinates and information.\n              source: {\n                type: 'geojson',\n                data: stores\n              }\n            });\n            */\n            // This function is for to load custom markers\n            map.current.addSource('places', {\n                type: 'geojson',\n                data: stores\n            });\n            buildLocationList(stores);\n            addMarkers()\n        });\n\n        const addMarkers = () => {\n            /* For each feature in the GeoJSON object above: */\n            for (const marker of stores.features) {\n                /* Create a div element for the marker. */\n                const el = document.createElement('div');\n                /* Assign a unique `id` to the marker. */\n                el.id = `marker-${marker.properties.id}`;\n                /* Assign the `marker` class to each marker for styling. */\n                el.className = 'marker';\n\n                /**\n                 * Create a marker using the div element\n                 * defined above and add it to the map.\n                 **/\n                new mapboxgl.Marker(el, { offset: [0, -23] })\n                    .setLngLat(marker.geometry.coordinates)\n                    .addTo(map.current);\n\n                el.addEventListener('click', (e) => {\n                    /* Fly to the point */\n                    flyToStore(marker);\n                    /* Close all other popups and display popup for clicked store */\n                    createPopUp(marker);\n                    /* Highlight listing in sidebar */\n                    const activeItem = document.getElementsByClassName('active');\n                    e.stopPropagation();\n                    if (activeItem[0]) {\n                        activeItem[0].classList.remove('active');\n                    }\n                    const listing = document.getElementById(`listing-${marker.properties.id}`);\n                    listing.classList.add('active');\n                });\n            }\n        }\n        /*\n        map.current.on('click', ({ point }) => {\n          // Determine if a feature in the \"locations\" layer exists at that point. \n          const features = map.current.queryRenderedFeatures(point, {\n            layers: ['locations']\n          });\n      \n          // If it does not exist, return \n          if (!features.length) return;\n      \n          const clickedPoint = features[0];\n      \n          //Fly to the point \n          flyToStore(clickedPoint);\n      \n          // Close all other popups and display popup for clicked store \n          createPopUp(clickedPoint);\n      \n          // Highlight listing in sidebar (and remove highlight for all other listings) \n          const activeItem = document.getElementsByClassName('active');\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active');\n          }\n          const listing = document.getElementById(\n            `listing-${clickedPoint.properties.id}`\n          );\n          listing.classList.add('active');\n        });\n        */\n    });\n\n    useEffect(() => {\n        if (!map.current) return; // wait for map to initialize\n        map.current.on('move', () => {\n            setLng(map.current.getCenter().lng.toFixed(4));\n            setLat(map.current.getCenter().lat.toFixed(4));\n\n            setZoom(map.current.getZoom().toFixed(2));\n        });\n    });\n\n    return (\n        <div>\n            <div class='sidebar'>\n                <div class='heading'>\n                    <h1>Dealer Orders</h1>\n                </div>\n                <div id='listings' className='listings'></div>\n            </div>\n            <div ref={mapContainer} className=\"map\" />\n        </div>\n    );\n}\n//Longitude: {lng} | Latitude: {lat} | Zoom: {zoom}\n\n\n"]},"metadata":{},"sourceType":"module"}